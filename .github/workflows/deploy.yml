name: 🚀 CI/CD Deploy ke Server (Self-Hosted)

on:
  push:
    branches:
      - main

jobs:
  deploy:
    name: Deploy on Local Server
    runs-on: self-hosted

    steps:
      - name: 🔁 Pull latest code
        run: |
          cd /var/www/html/testcicd
          git pull origin main

      - name: 🔐 Fix permissions
        run: |
          sudo chown -R www-data:www-data /var/www/html/testcicd
          sudo find /var/www/html/testcicd -type f -exec chmod 644 {} \;
          sudo find /var/www/html/testcicd -type d -exec chmod 755 {} \;

      - name: ✅ Done
        run: echo "Deploy sukses!"
